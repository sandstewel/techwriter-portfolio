{{ if and (not .IsHome) (or (.Params.ShowBreadCrumbs) (.Site.Params.ShowBreadCrumbs)) }}
<nav class="breadcrumbs" aria-label="Breadcrumb">
  {{/* Collect ancestors up the page tree */}}
  {{ $ancestors := slice }}
  {{ $parent := .Parent }}

  {{ range seq 0 10 }}
    {{ if $parent }}
      {{ if ne $parent.RelPermalink $.Site.BaseURL }}
        {{ $ancestors = $ancestors | append $parent }}
      {{ end }}
      {{ $parent = $parent.Parent }}
    {{ end }}
  {{ end }}

  {{/* Reverse order so top-level section comes first */}}
  {{ $count := sub (len $ancestors) 1 }}
  {{ range seq 0 $count }}
    {{ $i := sub $count . }}
    {{ $ancestor := index $ancestors $i }}
    {{ if eq . 0 }}
      <a href="{{ $ancestor.RelPermalink }}">{{ $ancestor.Title }}</a>
    {{ else }}
      &nbsp;›&nbsp;<a href="{{ $ancestor.RelPermalink }}">{{ $ancestor.Title }}</a>
    {{ end }}
  {{ end }}

  {{/* Current page at the end */}}
  &nbsp;›&nbsp;<span>{{ .Title }}</span>
</nav>
{{ end }}
