<script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>

<model-viewer id="pickMaterial"
              src="{{ .Get "src" }}"
              alt="{{ .Get "alt" }}"
              shadow-intensity="1"
              camera-controls
              touch-action="pan-y"
              disable-tap
              ar
              ar-modes="webxr"
              scale="100 100 100"
              style="width: 100%; height: 500px;">
</model-viewer>

<script type="module">
  const modelViewer = document.querySelector("model-viewer#pickMaterial");

  modelViewer.addEventListener("load", () => {
    const changeColor = (event) => {
      if (modelViewer.modelIsVisible) {
        const material = modelViewer.materialFromPoint(event.clientX, event.clientY);
        if (material != null) {
          material.pbrMetallicRoughness.setBaseColorFactor([
            Math.random(), Math.random(), Math.random(), 1
          ]);
        }
      }
    };
    document.addEventListener("click", changeColor);
  });
</script>
